<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff6b6b">
    <title>ColorMix - Palette Generator</title>
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .developer {
            color: #ff6b6b;
            opacity: 0.8;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        button:active {
            transform: translateY(-1px);
        }

        button.secondary {
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
        }

        .palette-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .color-card {
            background: #16213e;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .color-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .color-swatch {
            height: 200px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .copy-hint {
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .color-card:hover .copy-hint {
            opacity: 1;
        }

        .color-info {
            padding: 20px;
        }

        .color-hex {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
        }

        .color-rgb {
            font-size: 0.9em;
            color: #95a5a6;
            margin-bottom: 5px;
        }

        .saved-palettes {
            background: #16213e;
            border-radius: 15px;
            padding: 25px;
            margin-top: 40px;
        }

        .saved-palettes h2 {
            margin-bottom: 20px;
            color: #ff6b6b;
        }

        .saved-palette-item {
            background: #1a1a2e;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .saved-palette-colors {
            display: flex;
            gap: 5px;
            flex: 1;
        }

        .saved-color-box {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .saved-color-box:hover {
            transform: scale(1.1);
        }

        .delete-palette {
            background: #e74c3c;
            padding: 10px 20px;
            border-radius: 10px;
        }

        .load-palette {
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            padding: 10px 20px;
            border-radius: 10px;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .mode-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .mode-btn {
            background: #16213e;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .palette-container {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé® ColorMix</h1>
            <div class="developer">by vDig</div>
        </header>

        <div class="mode-selector">
            <button class="mode-btn active" onclick="setMode('random')">
                üé≤ Random
            </button>
            <button class="mode-btn" onclick="setMode('complementary')">
                ‚öñÔ∏è Complementary
            </button>
            <button class="mode-btn" onclick="setMode('analogous')">
                üåà Analogous
            </button>
            <button class="mode-btn" onclick="setMode('monochrome')">
                üé≠ Monochrome
            </button>
        </div>

        <div class="controls">
            <button onclick="generatePalette()">
                üé® Generate New Palette
            </button>
            <button class="secondary" onclick="savePalette()">
                üíæ Save Palette
            </button>
            <button class="secondary" onclick="exportPalette()">
                üì§ Export CSS
            </button>
        </div>

        <div class="palette-container" id="paletteContainer">
            <!-- Color cards will be generated here -->
        </div>

        <div class="saved-palettes">
            <h2>üíæ Saved Palettes</h2>
            <div id="savedPalettesContainer">
                <!-- Saved palettes will appear here -->
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }

        // App state
        let currentPalette = [];
        let savedPalettes = JSON.parse(localStorage.getItem('colormix_palettes') || '[]');
        let currentMode = 'random';

        // Set generation mode
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            generatePalette();
        }

        // Generate random color
        function randomColor() {
            return '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
        }

        // Convert hex to RGB
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        // Convert RGB to HSL
        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            return { h: h * 360, s: s * 100, l: l * 100 };
        }

        // Convert HSL to hex
        function hslToHex(h, s, l) {
            s /= 100; l /= 100;
            const a = s * Math.min(l, 1 - l);
            const f = n => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return `#${f(0)}${f(8)}${f(4)}`;
        }

        // Generate palette based on mode
        function generatePalette() {
            const baseColor = randomColor();
            const rgb = hexToRgb(baseColor);
            const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);

            switch(currentMode) {
                case 'complementary':
                    currentPalette = [
                        baseColor,
                        hslToHex((hsl.h + 180) % 360, hsl.s, hsl.l),
                        hslToHex(hsl.h, hsl.s * 0.7, hsl.l * 1.2),
                        hslToHex((hsl.h + 180) % 360, hsl.s * 0.7, hsl.l * 0.8),
                        hslToHex(hsl.h, hsl.s * 0.5, hsl.l * 0.5)
                    ];
                    break;
                case 'analogous':
                    currentPalette = [
                        hslToHex((hsl.h - 30 + 360) % 360, hsl.s, hsl.l),
                        hslToHex(hsl.h, hsl.s, hsl.l),
                        hslToHex((hsl.h + 30) % 360, hsl.s, hsl.l),
                        hslToHex((hsl.h + 60) % 360, hsl.s, hsl.l * 0.8),
                        hslToHex((hsl.h - 60 + 360) % 360, hsl.s, hsl.l * 1.2)
                    ];
                    break;
                case 'monochrome':
                    currentPalette = [
                        hslToHex(hsl.h, hsl.s, 90),
                        hslToHex(hsl.h, hsl.s, 70),
                        hslToHex(hsl.h, hsl.s, 50),
                        hslToHex(hsl.h, hsl.s, 30),
                        hslToHex(hsl.h, hsl.s, 10)
                    ];
                    break;
                default: // random
                    currentPalette = Array(5).fill(0).map(() => randomColor());
            }

            renderPalette();
        }

        // Render palette
        function renderPalette() {
            const container = document.getElementById('paletteContainer');
            container.innerHTML = currentPalette.map((color, index) => {
                const rgb = hexToRgb(color);
                return `
                    <div class="color-card" onclick="copyColor('${color}')">
                        <div class="color-swatch" style="background: ${color};">
                            <div class="copy-hint">Click to copy</div>
                        </div>
                        <div class="color-info">
                            <div class="color-hex">${color.toUpperCase()}</div>
                            <div class="color-rgb">RGB(${rgb.r}, ${rgb.g}, ${rgb.b})</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Copy color to clipboard
        function copyColor(color) {
            navigator.clipboard.writeText(color).then(() => {
                showToast(`Copied ${color}!`);
            });
        }

        // Save palette
        function savePalette() {
            const palette = {
                colors: currentPalette,
                timestamp: Date.now()
            };
            savedPalettes.unshift(palette);
            if (savedPalettes.length > 10) savedPalettes.pop();
            localStorage.setItem('colormix_palettes', JSON.stringify(savedPalettes));
            renderSavedPalettes();
            showToast('Palette saved!');
        }

        // Export palette as CSS
        function exportPalette() {
            const css = currentPalette.map((color, index) => 
                `  --color-${index + 1}: ${color};`
            ).join('\n');
            
            const fullCss = `:root {\n${css}\n}`;
            
            navigator.clipboard.writeText(fullCss).then(() => {
                showToast('CSS variables copied!');
            });
        }

        // Load palette
        function loadPalette(index) {
            currentPalette = savedPalettes[index].colors;
            renderPalette();
            showToast('Palette loaded!');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Delete palette
        function deletePalette(index) {
            if (confirm('Delete this palette?')) {
                savedPalettes.splice(index, 1);
                localStorage.setItem('colormix_palettes', JSON.stringify(savedPalettes));
                renderSavedPalettes();
                showToast('Palette deleted');
            }
        }

        // Render saved palettes
        function renderSavedPalettes() {
            const container = document.getElementById('savedPalettesContainer');
            
            if (savedPalettes.length === 0) {
                container.innerHTML = '<p style="color: #95a5a6; text-align: center;">No saved palettes yet</p>';
                return;
            }

            container.innerHTML = savedPalettes.map((palette, index) => `
                <div class="saved-palette-item">
                    <div class="saved-palette-colors">
                        ${palette.colors.map(color => `
                            <div class="saved-color-box" 
                                 style="background: ${color};"
                                 onclick="copyColor('${color}')"
                                 title="${color}">
                            </div>
                        `).join('')}
                    </div>
                    <button class="load-palette" onclick="loadPalette(${index})">
                        Load
                    </button>
                    <button class="delete-palette" onclick="deletePalette(${index})">
                        üóëÔ∏è
                    </button>
                </div>
            `).join('');
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // Keyboard shortcut for generating new palette
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' || e.code === 'Space') {
                e.preventDefault();
                generatePalette();
            }
        });

        // Initialize
        generatePalette();
        renderSavedPalettes();
    </script>
</body>
</html>